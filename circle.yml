machine:
  node:
      version: 0.10.32
general:
  artifacts:
    - dist.tar.gz
dependencies:
  post:
    - bower install --force-latest
    - git config --global user.email "jenkins@risevision.com"
    - git config --global user.name "jenkins-rise"
deployment:
  automerge:
    branch: /(feature|fix|chore).*/
    commands:
      - git checkout stage
      - git pull origin stage
      - git merge $CIRCLE_BRANCH -m "Merged commit $CIRCLE_SHA1 into $CIRCLE_BRANCH"
      - git push origin stage
  staging:
    branch: stage
    commands:
          - NODE_ENV=stage npm run ci-build
          - rsync -rptz -e ssh --delete web devhub@developer.stage.risevision.com:/rise-front-end/developer-hub
          - tar czvf dist.tar.gz web
  production:
      branch: master
      commands:
        - NODE_ENV=prod npm run ci-build
        - rsync -rptz -e ssh --delete web devhub@developer.risevision.com:/rise-front-end/developer-hub
        - tar czvf dist.tar.gz web
